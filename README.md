# must

mustの名称は、MarkUp Support Toolの頭文字から、です。

MarkdownやLaTeXなどのマークアップ言語で文章を書いていると、特殊文字のエスケープ処理や、リンク(LaTeXの場合の\\hrefなど)のために
タイトルの確認など、機械的な作業が必要になります。このあたりで楽をしたいと思って作りました。
具体的には、以下のような機能があります。

- テキストに含まれる特殊文字をエスケープ処理します。
- 見出しや脚注を作成するときに含まれる特殊文字をエスケープ処理します。
- 指定されたURLからwebページにアクセスして、タイトルを取得して、リンクを作成します。
- 指定されたURLからリンクを作成して、URLを脚注とします。

mustの画面はテキストエリア一つと、いくつかのボタンです。テキストエリアに処理したいテキストを入力して、ボタンをクリックすると、
ボタンに割り当てられた処理をした結果がテキストエリアに表示されます
表示されたテキストをコピーして、作成している文章に貼り付ければマークアップ言語として正しく処理されます。

いまのところはLaTeXのみですが、Markdownの特殊文字の変換とリンクの作成にも対応予定です。

## 動作環境

開発した環境は以下の通りです。

- Ubuntu 18.04
- Node.js v12.14.0
- yarn 1.19.1
- Nuxt.js 2.0.0

Node.jsが動作する環境であれば、動作すると思います。

特殊文字のエスケープ処理や、見出し/脚注の作成などの文字列の操作は、
Webブラウザで動作するJavascriptプログラムで実装しました。
Webブラウザ環境のJavascriptから、タイトルを取得するためにwebページにアクセスするとCORS違反が発生するため、
タイトルを取得するためのwebページのアクセスは、Node.jsで開発したサーバ環境に実装しています。
手元で動かすために、開発サーバでの利用を想定しています。

## LaTeX

### LaTexの特殊文字の変換

LaTeXなどのマークアップ言語では、テキストの中にコマンドを埋め込むため、コマンドの開始を意味する文字、いわゆる特殊文字が必要です。
たとえばLaTeXの場合は\\がコマンドを開始する文字です。コマンドを開始する文字そのものをテキストの中で参照する場合には、
コマンドの開始ではない意図で書かれていることを指示するために、特別な書き方をします。
たとえば、LaTeXで\\そのものを書くには、\\textbackslashと書きます。

LaTeXでは特殊文字は以下の通りです。

出力 | 入力
---- | ----
^ | \textasciicircum
~ | \textasciitilde
\ | \textbackslash
\# | \\#
$ | \\$
% | \\%
& | \\&
_ | \\_
{ | \\{
} | \\}

mustは、特殊な文字を含むテキストを、マークアップ言語で決められた特別な書き方に、ボタン一つで変換します。

### 脚注の作成

footnoteボタンをクリックすると、LaTeXの脚注の形式に変換します。変換するときに、同時に以下の処理もします。

- 特殊文字を変換します。
- 改行、タブを空白に変換します。
- 先頭および末端の空白、改行、タブを除去します。

以下が変換の例です。

変換前 | 変換後
-- | --
脚注1 | \footnote{脚注1}
foot_note_2 | \footnote{foot\\_note\\_2}
脚注3\nあいう | \footnote{脚注3 あいう}
脚注\t4 | \footnote{脚注 4}
\nxyz | \footnote{xyz}

### 見出しの作成

以下のボタンをクリックすると、LaTeXの見出しの形式に変換します。

- chapter
- section
- subsection
- subsubsection
- paragraph
- subparagraph

変換するときに、同時に以下の処理もします。

- 特殊文字を変換します。
- 改行、タブを空白に変換します。
- 先頭および末端の空白、改行、タブを除去します。

以下が変換の例です。

変換前 | 見出しの種類 | 変換後
-- | -- | --
見出し1 | section | \section{見出し1}
sub_section_2 | subsection | \subsection{sub\_section\_2}
見出し3\nあいうえお | subsubsection | \subsubsection{見出し3 あいうえお}
見出し\t4 | paragraph | \paragraph{見出し 4}
\nxyz | subparagraph | \subparagraph{xyz}

### リンク(\href)の作成

webページのURLから`\href{URL}{title}を作成します。

テキストエリアにwebページのURLを入力してからhrefのボタンをクリックすると、URLで指定されたwebページのtitleタグから取得したタイトルから、上の形式を作成します。titleに特殊文字が含まれる場合にはエスケープ処理をします。

たとえば、<https://www.google.co.jp/> を入力してhrefボタンをクリックすると、`\href{https://www.google.co.jp/}{Google}`に変換します。

### 脚注付きのリンク

リンク先のアドレス(URL)と、そのwebページのタイトル(title)とすると、`\href{URL}{title}\footnote{\url{url}}`を作成します。

\\hrefでリンクを作成した場合、PDFファイルを画面に表示したときにはリンクにカーソルを当てるとリンク先のアドレスが表示されますが、
印刷してしまうとリンク先のアドレスを確認することができなくなってしまいます。
リンク先を脚注として表示することで、印刷してもリンク先が確認できるようになります。

たとえばテキストエリアにwebページのURL、<https://www.google.co.jp/> を入力して、
「脚注付きのリンク」ボタンをクリックすると、テキストエリアに `\href{https://www.google.co.jp/}{Google}\footnote{\url{https://www.google.co.jp/}}`に変換します。
これをLaTeXで処理した結果が、以下の画像です。

![脚注付きのリンク](/work/footnote_href.png)

## Markdown

### Markdownの特殊文字の変換

Markdownの特殊文字として、以下の文字がテキストエリアのテキストに含まれている場合には、特殊文字の直前に\\(バックスラッシュ)を追加します。

``\*_`#+-.!{}[]()``

## 使い方

1. [GitHubのリポジトリ](https://github.com/kubotama/must)からソースコードをダウンロードします。

1. `yarn install`で必要なモジュールをインストールします。

1. `yarn dev`でローカルサーバー環境を起動します。

1. Webブラウザで <http://localhost:3333/> にアクセスします。

1. テキストエリアにテキストを入力して、処理したいボタンをクリックします。

他のNode.jsで開発したWebアプリケーションなどとのポート番号の競合を避けるため、ポート番号をデフォルトの3000から
3333に変更してあります。
ポート番号が競合する場合には、package.jsonファイルの
scriptsセクションのdevで割り当てているコマンドの引数で指定しているポート番号を変更してください。

## お願い

Nuxt.jsやVue.jsを勉強していて、なにか作りたいと思って作ってみました。node.jsやNuxt.js, Vue.jsに慣れていませんので、いろいろとおかしなところもあると思いますが、お手柔らかなご指摘をお願いできると有難いです。
